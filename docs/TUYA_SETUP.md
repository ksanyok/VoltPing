# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Tuya API

–î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ Tuya Cloud API —Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è.

## üìã –ó–º—ñ—Å—Ç

1. [–°—Ç–≤–æ—Ä–µ–Ω–Ω—è Tuya Developer Account](#1-—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è-tuya-developer-account)
2. [–°—Ç–≤–æ—Ä–µ–Ω–Ω—è Cloud Project](#2-—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è-cloud-project)
3. [–ü—Ä–∏–≤'—è–∑–∫–∞ Smart Life Account](#3-–ø—Ä–∏–≤—è–∑–∫–∞-smart-life-account)
4. [–û—Ç—Ä–∏–º–∞–Ω–Ω—è Device ID](#4-–æ—Ç—Ä–∏–º–∞–Ω–Ω—è-device-id)
5. [–û—Ç—Ä–∏–º–∞–Ω–Ω—è Local Key](#5-–æ—Ç—Ä–∏–º–∞–Ω–Ω—è-local-key)
6. [–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è](#6-–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è-–ª–æ–∫–∞–ª—å–Ω–æ–≥–æ-–ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è)

---

## 1. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Tuya Developer Account

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ [iot.tuya.com](https://iot.tuya.com/)
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Register** –∞–±–æ **Sign Up**
3. –û–±–µ—Ä—ñ—Ç—å **Developer Account**
4. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å —Ñ–æ—Ä–º—É:
   - Email
   - Password
   - Country: Ukraine (–∞–±–æ –≤–∞—à–∞ –∫—Ä–∞—ó–Ω–∞)
5. –ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å email

---

## 2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Cloud Project

1. –£–≤—ñ–π–¥—ñ—Ç—å –≤ [Tuya IoT Platform](https://iot.tuya.com/)
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –≤ **Cloud** ‚Üí **Development**
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Create Cloud Project**
4. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å:
   - **Project Name**: VoltPing (–∞–±–æ –≤–∞—à–∞ –Ω–∞–∑–≤–∞)
   - **Description**: Power monitoring
   - **Industry**: Smart Home
   - **Development Method**: Smart Home
   - **Data Center**: **Central Europe** (–¥–ª—è –£–∫—Ä–∞—ó–Ω–∏)
   
   ‚ö†Ô∏è **–í–∞–∂–ª–∏–≤–æ!** –í–∏–±–µ—Ä—ñ—Ç—å Data Center –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —Ä–µ–≥—ñ–æ–Ω—É –≤–∞—à–æ–≥–æ Smart Life –∞–∫–∞—É–Ω—Ç—É!

5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Create**

### –ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ API —Å–µ—Ä–≤—ñ—Å–∏

–ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ–µ–∫—Ç—É –¥–æ–¥–∞–π—Ç–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ API:

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –≤ **Cloud** ‚Üí **Development** ‚Üí –í–∞—à –ø—Ä–æ–µ–∫—Ç
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Subscribe** 
3. –î–æ–¥–∞–π—Ç–µ:
   - **IoT Core** (–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ)
   - **Authorization Management** (–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ)
   - **Smart Home Device Control** (–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ)

### –û—Ç—Ä–∏–º–∞–Ω–Ω—è API –∫–ª—é—á—ñ–≤

1. –í –ø—Ä–æ–µ–∫—Ç—ñ –ø–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Overview**
2. –°–∫–æ–ø—ñ—é–π—Ç–µ:
   - **Access ID/Client ID**: `–≤–∞—à_access_id`
   - **Access Secret/Client Secret**: `–≤–∞—à_secret`

---

## 3. –ü—Ä–∏–≤'—è–∑–∫–∞ Smart Life Account

–©–æ–± –±–∞—á–∏—Ç–∏ —Å–≤–æ—ó –ø—Ä–∏—Å—Ç—Ä–æ—ó —á–µ—Ä–µ–∑ API, –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–∏–≤'—è–∑–∞—Ç–∏ Smart Life –∞–∫–∞—É–Ω—Ç:

1. –í –ø—Ä–æ–µ–∫—Ç—ñ –ø–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Devices**
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Link Tuya App Account**
3. –í–∏–±–µ—Ä—ñ—Ç—å **Tuya Smart** –∞–±–æ **Smart Life** (–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –≤–∞—à–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É)
4. –í—ñ–¥—Å–∫–∞–Ω—É—é—Ç—å QR-–∫–æ–¥ —á–µ—Ä–µ–∑ –º–æ–±—ñ–ª—å–Ω–∏–π –¥–æ–¥–∞—Ç–æ–∫:
   - –í—ñ–¥–∫—Ä–∏–π—Ç–µ Smart Life / Tuya Smart
   - –ü–µ—Ä–µ–π–¥—ñ—Ç—å –≤ **Profile** ‚Üí **Settings** (‚öôÔ∏è)
   - **Scan QR code** –∞–±–æ **Add device by scanning**

5. –ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å –ø—Ä–∏–≤'—è–∑–∫—É –≤ –¥–æ–¥–∞—Ç–∫—É

–ü—ñ—Å–ª—è –ø—Ä–∏–≤'—è–∑–∫–∏ –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ –≤—Å—ñ —Å–≤–æ—ó –ø—Ä–∏—Å—Ç—Ä–æ—ó –≤ —Ä–æ–∑–¥—ñ–ª—ñ **All Devices**.

---

## 4. –û—Ç—Ä–∏–º–∞–Ω–Ω—è Device ID

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å **Devices** ‚Üí **All Devices**
2. –ó–Ω–∞–π–¥—ñ—Ç—å –≤–∞—à—É —Ä–æ–∑–µ—Ç–∫—É –∑ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è–º –Ω–∞–ø—Ä—É–≥–∏
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **View Details**
4. –°–∫–æ–ø—ñ—é–π—Ç–µ **Device ID**: `bf1234567890abcd`

### –Ø–∫ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø—Ä–∏—Å—Ç—Ä—ñ–π?

–Ø–∫—â–æ —É –≤–∞—Å –±–∞–≥–∞—Ç–æ –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤:
- –ù–∞–∑–≤–∞ –ø—Ä–∏—Å—Ç—Ä–æ—é —Å–ø—ñ–≤–ø–∞–¥–∞—î –∑ –Ω–∞–∑–≤–æ—é –≤ Smart Life
- **Product Name** –∑–∞–∑–≤–∏—á–∞–π –º—ñ—Å—Ç–∏—Ç—å "Smart Plug" –∞–±–æ "Socket"
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ **Status** ‚Äî –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä `cur_voltage` –∞–±–æ `voltage`

---

## 5. –û—Ç—Ä–∏–º–∞–Ω–Ω—è Local Key

Local Key –ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–ª—è –ø—Ä—è–º–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é (–±–µ–∑ API –ª—ñ–º—ñ—Ç—ñ–≤).

### –ú–µ—Ç–æ–¥ 1: –ß–µ—Ä–µ–∑ Tuya IoT Platform

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å **Devices** ‚Üí **All Devices**
2. –ó–Ω–∞–π–¥—ñ—Ç—å –≤–∞—à –ø—Ä–∏—Å—Ç—Ä—ñ–π
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **View Details**
4. –°–∫–æ–ø—ñ—é–π—Ç–µ **Local Key**: `Oy<wipCyx6qSC:EW`

### –ú–µ—Ç–æ–¥ 2: –ß–µ—Ä–µ–∑ tinytuya wizard

```bash
# –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å tinytuya
pip install tinytuya

# –ó–∞–ø—É—Å—Ç—ñ—Ç—å wizard
python -m tinytuya wizard
```

Wizard –∑–∞–ø–∏—Ç–∞—î:
1. API Region (Central Europe –¥–ª—è –£–∫—Ä–∞—ó–Ω–∏)
2. API Key (Access ID)
3. API Secret
4. Device ID (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

–†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ –≤ `devices.json`.

### –ú–µ—Ç–æ–¥ 3: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è

VoltPing –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∑–Ω–∞—á–∞—î Local Key –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É —á–µ—Ä–µ–∑ Cloud API. –ü—Ä–æ—Å—Ç–æ –∑–∞–ª–∏—à—Ç–µ –ø–æ–ª–µ `TUYA_LOCAL_KEY` –ø–æ—Ä–æ–∂–Ω—ñ–º.

---

## 6. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –í–∏–∑–Ω–∞—á—Ç–µ IP –ø—Ä–∏—Å—Ç—Ä–æ—é

**–ß–µ—Ä–µ–∑ —Ä–æ—É—Ç–µ—Ä:**
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å —Ä–æ—É—Ç–µ—Ä–∞ (–∑–∞–∑–≤–∏—á–∞–π 192.168.1.1)
2. –ó–Ω–∞–π–¥—ñ—Ç—å —Å–ø–∏—Å–æ–∫ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤
3. –ó–Ω–∞–π–¥—ñ—Ç—å –ø—Ä–∏—Å—Ç—Ä—ñ–π –∑ –Ω–∞–∑–≤–æ—é —Ç–∏–ø—É "ESP_XXXX" –∞–±–æ MAC-–∞–¥—Ä–µ—Å–æ—é Tuya

**–ß–µ—Ä–µ–∑ Smart Life:**
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –ø—Ä–∏—Å—Ç—Ä—ñ–π –≤ Smart Life
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ ‚öôÔ∏è (–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è)
3. –ó–Ω–∞–π–¥—ñ—Ç—å IP –∞–¥—Ä–µ—Å—É (–Ω–µ –∑–∞–≤–∂–¥–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)

**–ß–µ—Ä–µ–∑ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ:**
```bash
# Linux/Mac
nmap -sP 192.168.1.0/24

# –ê–±–æ –∑–Ω–∞–π–¥—ñ—Ç—å –ø–æ—Ä—Ç 6668
nmap -p 6668 192.168.1.0/24
```

### –ö—Ä–æ–∫ 2: –¢–µ—Å—Ç –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ –ø–æ—Ä—Ç—É
nc -zv 192.168.1.100 6668

# –ê–±–æ —á–µ—Ä–µ–∑ telnet
telnet 192.168.1.100 6668
```

### –ö—Ä–æ–∫ 3: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è .env

```env
TUYA_MODE="local"
TUYA_LOCAL_IP="192.168.1.100"
TUYA_LOCAL_KEY="Oy<wipCyx6qSC:EW"
TUYA_LOCAL_VERSION="3.5"
```

### –í–µ—Ä—Å—ñ—ó –ø—Ä–æ—Ç–æ–∫–æ–ª—É

| –í–µ—Ä—Å—ñ—è | –†—ñ–∫ –≤–∏–ø—É—Å–∫—É | –ü—Ä–∏–º—ñ—Ç–∫–∏ |
|--------|-------------|----------|
| 3.1    | 2018        | –°—Ç–∞—Ä—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó |
| 3.3    | 2019        | –ë—ñ–ª—å—à—ñ—Å—Ç—å –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤ |
| 3.4    | 2021        | –ù–æ–≤—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó |
| 3.5    | 2022+       | –ù–∞–π–Ω–æ–≤—ñ—à—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó |

–Ø–∫—â–æ –Ω–µ –ø—Ä–∞—Ü—é—î ‚Äî —Å–ø—Ä–æ–±—É–π—Ç–µ —ñ–Ω—à—ñ –≤–µ—Ä—Å—ñ—ó (3.5 ‚Üí 3.4 ‚Üí 3.3).

---

## üîß Troubleshooting

### "Token expired"
- –¢–æ–∫–µ–Ω –∫–µ—à—É—î—Ç—å—Å—è, –≤–∏–¥–∞–ª—ñ—Ç—å `tuya_token.json` —ñ —Å–ø—Ä–æ–±—É–π—Ç–µ –∑–Ω–æ–≤—É

### "Device is offline"
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç-–∑'—î–¥–Ω–∞–Ω–Ω—è –ø—Ä–∏—Å—Ç—Ä–æ—é
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ –ø—Ä–∏—Å—Ç—Ä—ñ–π –æ–Ω–ª–∞–π–Ω –≤ Smart Life

### "Permission denied"
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ –ø—ñ–¥–ø–∏—Å–∞–Ω—ñ –Ω–∞ API —Å–µ—Ä–≤—ñ—Å–∏
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ –ø—Ä–∏–≤'—è–∑–∞–Ω–∏–π Smart Life account

### "Local connection timeout"
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ IP –∞–¥—Ä–µ—Å—É
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –ø–æ—Ä—Ç 6668
- –°–ø—Ä–æ–±—É–π—Ç–µ —ñ–Ω—à—É –≤–µ—Ä—Å—ñ—é –ø—Ä–æ—Ç–æ–∫–æ–ª—É

### "Invalid local key"
- Local Key –º—ñ–≥ –∑–º—ñ–Ω–∏—Ç–∏—Å—è –ø—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è firmware
- –û—Ç—Ä–∏–º–∞–π—Ç–µ –Ω–æ–≤–∏–π –∫–ª—é—á —á–µ—Ä–µ–∑ API –∞–±–æ wizard

---

## üìö –ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

- [Tuya IoT Platform](https://iot.tuya.com/)
- [Tuya Developer Documentation](https://developer.tuya.com/en/docs/iot)
- [tinytuya GitHub](https://github.com/jasonacox/tinytuya)
- [Smart Life App](https://play.google.com/store/apps/details?id=com.tuya.smartlife)
